(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{21:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(11),o=n.n(r),s=(n(19),n(20),n(21),n(6)),i=n(5),l=n(9),u=n(2),d=n(3),b=n.n(d),j=n(4),p=n.n(j),f="https://mate.academy/students-api";function m(e){return new Promise((function(t){setTimeout(t,e)}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a={method:t};return n&&(a.body=JSON.stringify(n),a.headers={"Content-Type":"application/json; charset=UTF-8"}),m(300).then((function(){return fetch(f+e,a)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O=function(e){return h(e)},v=function(e,t){return h(e,"POST",t)},x=function(e,t){return h(e,"PATCH",t)},y=function(e){return h(e,"DELETE")},g=function(e){return v("/todos",e)},N=function(e,t,n){return x("/todos/".concat(e),{title:n,completed:t})},k=function(e){return y("/todos/".concat(e))},C=n(0),_=c.a.memo((function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),c=n[0],r=n[1],o=e.handleCreateTodo,s=Object(a.useRef)(null);Object(a.useEffect)((function(){s.current&&s.current.focus()}),[]);return Object(C.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(c),r("")},children:[Object(C.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:s,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:c,onChange:function(e){return r(e.target.value)}}),Object(C.jsx)("button",{type:"submit","aria-label":"Save",style:{display:"none"}})]})})),w=function(){var e=Object(i.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(i.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,a=t.name,e.abrupt("return",v("/users",{email:n,name:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(u.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(""),l=Object(u.a)(s,2),d=l[0],j=l[1],f=Object(a.useState)(!1),m=Object(u.a)(f,2),h=m[0],O=m[1],v=Object(a.useState)(!1),x=Object(u.a)(v,2),y=x[0],g=x[1],N=Object(a.useState)(""),k=Object(u.a)(N,2),_=k[0],T=k[1],E=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(a.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(a){}}),[]);var F=function(){var e=Object(i.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(r);case 2:(t=e.sent)?E(t):O(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(i.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),T(""),g(!0),e.prev=3,!h){e.next=9;break}return e.next=7,S({name:d,email:r}).then(E);case 7:e.next=11;break;case 9:return e.next=11,F();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),T("Something went wrtong");case 16:return e.prev=16,g(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(C.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(C.jsx)("h1",{className:"title is-3",children:h?"You need to register":"Log in to open todos"}),Object(C.jsxs)("div",{className:"field",children:[Object(C.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(C.jsxs)("div",{className:p()("control has-icons-left",{"is-loading":y}),children:[Object(C.jsx)("input",{type:"email",id:"user-email",className:p()("input",{"is-danger":!h&&_}),placeholder:"Enter your email",disabled:y||h,value:r,required:!0,onChange:function(e){return o(e.target.value)}}),Object(C.jsx)("span",{className:"icon is-small is-left",children:Object(C.jsx)("i",{className:"fas fa-envelope"})})]}),!h&&_&&Object(C.jsx)("p",{className:"help is-danger",children:_})]}),h&&Object(C.jsxs)("div",{className:"field",children:[Object(C.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(C.jsxs)("div",{className:p()("control has-icons-left",{"is-loading":y}),children:[Object(C.jsx)("input",{type:"text",id:"user-name",className:p()("input",{"is-danger":h&&_}),placeholder:"Enter your name",required:!0,minLength:4,disabled:y,value:d,onChange:function(e){return j(e.target.value)}}),Object(C.jsx)("span",{className:"icon is-small is-left",children:Object(C.jsx)("i",{className:"fas fa-user"})})]}),h&&_&&Object(C.jsx)("p",{className:"help is-danger",children:_})]}),Object(C.jsx)("div",{className:"field",children:Object(C.jsx)("button",{type:"submit",className:p()("button is-primary",{"is-loading":y}),children:h?"Register":"Login"})})]})},E=c.a.createContext(null),F=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(u.a)(n,2),r=c[0],o=c[1];return r?Object(C.jsx)(E.Provider,{value:r,children:t}):Object(C.jsx)(T,{onLogin:o})},L=function(e){var t=e.todos,n=e.filter,a=e.setFilter,c=e.deleteAllCompleted,r=e.todosLeft;return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(r," items left")}),Object(C.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(C.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:p()("filter__link",{selected:"all"===n}),onClick:function(e){e.preventDefault(),"all"!==n&&a("all")},children:"All"}),Object(C.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:p()("filter__link",{selected:"active"===n}),onClick:function(e){e.preventDefault(),"active"!==n&&a("active")},children:"Active"}),Object(C.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:p()("filter__link",{selected:"completed"===n}),onClick:function(e){e.preventDefault(),"completed"!==n&&a("completed")},children:"Completed"})]}),Object(C.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){return c()},style:{visibility:t.some((function(e){return e.completed}))?"visible":"hidden"},children:"Clear completed"})]})},D=function(e){var t=e.todo,n=e.todos,c=e.setTodos,r=e.setError,o=e.loading,l=e.activeTodoId,d=e.remove,j=t.title,f=t.id,m=t.completed,h=Object(a.useState)(!1),O=Object(u.a)(h,2),v=O[0],x=O[1],y=Object(a.useState)(""),g=Object(u.a)(y,2),k=g[0],_=g[1],w=function(){var e=Object(i.a)(b.a.mark((function e(t,a){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(n.map((function(e){return e.id===f?Object(s.a)(Object(s.a)({},e),{},{completed:a,title:t}):Object(s.a)({},e)}))),e.prev=1,e.next=4,N(f,a,t);case 4:o=n.map((function(e){return e.id===f?Object(s.a)(Object(s.a)({},e),{},{title:t,completed:a}):Object(s.a)({},e)})),c(o),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r("update");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),S=function(e){e.preventDefault(),k?(r(""),k!==t.title&&w(k,t.completed),x(!1)):d(f)};return Object(C.jsxs)("div",{"data-cy":"Todo",className:p()("todo",{completed:m}),children:[Object(C.jsx)("label",{className:"todo__status-label",children:Object(C.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:m,onChange:function(){return w(j,!m)}})}),v?Object(C.jsx)("form",{onBlur:S,onSubmit:S,children:Object(C.jsx)("input",{"data-cy":"NewTodoField",type:"text",className:"todoapp__new-todo",placeholder:"Empty todo will be deleted",value:k,onChange:function(e){return _(e.target.value)},onKeyDown:function(e){"Escape"===e.key&&(_(""),x(!1))}})}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){_(j),x(!0)},children:j}),Object(C.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return d(f)},children:"x"})]}),Object(C.jsxs)("div",{"data-cy":"TodoLoader",className:p()("modal overlay",{"is-active":o&&f===l}),children:[Object(C.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(C.jsx)("div",{className:"loader"})]})]})},A=function(){var e=Object(a.useContext)(E),t=Object(a.useState)([]),n=Object(u.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)("all"),d=Object(u.a)(o,2),j=d[0],f=d[1],m=Object(a.useState)(""),h=Object(u.a)(m,2),v=h[0],x=h[1],y=Object(a.useState)(!1),w=Object(u.a)(y,2),S=w[0],T=w[1],F=Object(a.useState)(!1),A=Object(u.a)(F,2),I=A[0],B=A[1],J=Object(a.useState)(null),P=Object(u.a)(J,2),U=P[0],q=P[1];Object(a.useEffect)((function(){var t;e&&(t=e.id,O("/todos?userId=".concat(t))).then((function(e){r(e)}))}),[e]);var H=function(e){r((function(t){return[].concat(Object(l.a)(t),[e])}))},R=Object(a.useCallback)(function(){var t=Object(i.a)(b.a.mark((function t(n){var a,o,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B(!0),e){t.next=3;break}return t.abrupt("return");case 3:if(n.trim()){t.next=6;break}return x("Please add title"),t.abrupt("return");case 6:return a=-c.length,o={id:a,userId:e.id,title:n,completed:!1},H(o),q(a),t.prev=10,t.next=13,g({title:n,userId:e.id,completed:!1});case 13:s=t.sent,r((function(e){return e.map((function(e){return e.id===a?s:e}))})),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(10),r((function(e){return e.filter((function(e){return e.id!==a}))})),x("Unable to add a todo");case 21:B(!1),x("");case 23:case"end":return t.stop()}}),t,null,[[10,17]])})));return function(e){return t.apply(this,arguments)}}(),[e,c.length]),Y=Object(a.useCallback)((function(e){switch(e){case"active":return c.filter((function(e){return!e.completed}));case"completed":return c.filter((function(e){return e.completed}));default:return c}}),[c]),G=Object(a.useCallback)(function(){var t=Object(i.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B(!0),q(n),e){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,t.next=7,k(n);case 7:r((function(e){return e.filter((function(e){return e.id!==n}))})),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),x("Unable to delete a todo");case 13:B(!1);case 14:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}(),[e]),K=Object(a.useCallback)((function(){c.forEach((function(e){e.completed&&G(e.id)}))}),[G,c]),W=Object(a.useCallback)((function(){var e=Object(l.a)(c).map((function(e){return N(e.id,!S,e.title).catch((function(){return x("Unable to update a todo")})),Object(s.a)(Object(s.a)({},e),{},{completed:!S})}));r(e),T((function(e){return!e}))}),[S,c]),z=Y(j);return Object(C.jsxs)("div",{className:"todoapp",children:[Object(C.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(C.jsxs)("div",{className:"todoapp__content",children:[Object(C.jsxs)("header",{className:"todoapp__header",children:[c.length>0&&Object(C.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:p()("todoapp__toggle-all",{active:c.length&&c.every((function(e){return e.completed}))}),onClick:function(){return W()}}),Object(C.jsx)(_,{handleCreateTodo:R})]}),Object(C.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:z.map((function(e){return Object(C.jsx)(D,{todo:e,todos:c,setTodos:r,setError:x,loading:I,activeTodoId:U,remove:G},e.id)}))}),Object(C.jsx)("footer",{className:"todoapp__footer","data-cy":"Footer",children:Object(C.jsx)(L,{todos:c,todosLeft:c.filter((function(e){return!e.completed})).length,filter:j,setFilter:f,deleteAllCompleted:K})})]}),Object(C.jsxs)("div",{"data-cy":"ErrorNotification",className:p()("notification","is-danger","is-light","has-text-weight-normal",{hidden:""===v}),children:[Object(C.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return x("")}}),v]})]})};o.a.render(Object(C.jsx)(F,{children:Object(C.jsx)(A,{})}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.f97db5d8.chunk.js.map